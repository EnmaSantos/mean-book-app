<h2>Add New Book</h2>

<form [formGroup]="bookForm" (ngSubmit)="onSubmit()" class="book-form">

  <mat-form-field appearance="outline">
    <mat-label>Title</mat-label>
    <input matInput id="title" type="text" formControlName="title" required>
    <mat-error *ngIf="title?.invalid && (title?.dirty || title?.touched)">
      <span *ngIf="title?.errors?.['required']">Title is required.</span>
      <span *ngIf="title?.errors?.['minlength']">Title must be at least 3 characters.</span>
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Author</mat-label>
    <input matInput id="author" type="text" formControlName="author" required>
    <mat-error *ngIf="author?.invalid && (author?.dirty || author?.touched)">
      <span *ngIf="author?.errors?.['required']">Author is required.</span>
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Genre</mat-label>
    <input matInput id="genre" type="text" formControlName="genre">
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Publication Year</mat-label>
    <input matInput id="publicationYear" type="number" formControlName="publicationYear">
    <mat-error *ngIf="publicationYear?.invalid && (publicationYear?.dirty || publicationYear?.touched)">
      <span *ngIf="publicationYear?.errors?.['min'] || publicationYear?.errors?.['max']">Please enter a valid year.</span>
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Rating (1-5)</mat-label>
    <input matInput id="rating" type="number" formControlName="rating" min="1" max="5">
    <mat-error *ngIf="rating?.invalid && (rating?.dirty || rating?.touched)">
      <span *ngIf="rating?.errors?.['min'] || rating?.errors?.['max']">Rating must be between 1 and 5.</span>
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Cover Image URL</mat-label>
    <input matInput id="coverImageUrl" type="url" formControlName="coverImageUrl" placeholder="https://example.com/image.jpg">
  </mat-form-field>
  
  <div class="form-actions">
    <button mat-raised-button color="primary" type="submit" [disabled]="bookForm.invalid || isSubmitting">
      {{ isSubmitting ? 'Adding...' : 'Add Book' }}
    </button>
    <a mat-stroked-button routerLink="/">Cancel</a>
  </div>

  <div *ngIf="errorMessage" class="error-message" style="color: darkred; margin-top: 10px;">
    <p>Error: {{ errorMessage }}</p>
  </div>

</form>